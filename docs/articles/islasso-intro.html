<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>An Introduction to islasso • islasso</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="An Introduction to islasso">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">islasso</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.6.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/islasso-intro.html">Get Started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="dropdown-item" href="../articles/islasso-intro.html">Introduction to islasso</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gianluca-sottile/islasso" aria-label="GitHub repository"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>An Introduction to islasso</h1>
                        <h4 data-toc-skip class="author">Gianluca
Sottile</h4>
                        <h4 data-toc-skip class="author">Giovanna
Cilluffo</h4>
                        <h4 data-toc-skip class="author">Vito M.R.
Muggeo</h4>
            
            <h4 data-toc-skip class="date">August 01, 2025</h4>
      

      <div class="d-none name"><code>islasso-intro.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="abstract">Abstract<a class="anchor" aria-label="anchor" href="#abstract"></a>
</h2>
<p>In this short note we present and briefly discuss the R package
islasso dealing with regression models having a large number of
covariates. Estimation is carried out by penalizing the coefficients via
a quasi-lasso penalty, wherein the nonsmooth lasso penalty is replaced
by its smooth counterpart determined iteratively by data according to
the induced smoothing idea. The package includes functions to estimate
the model and to test for linear hypothesis on linear combinations of
relevant coefficients. We illustrate R code throughout a worked example,
by avoiding intentionally to report details and extended
bibliography.</p>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Let <span class="math inline">\mathbf{y} = \mathbf{X}\beta +
\mathbf{\epsilon}</span> be the linear model of interest with usual
zero-means and homoscedastic errors. As usual, <span class="math inline">\mathbf{y} = (y_1,\ldots,y_n)^T</span> is the
response vector, <span class="math inline">\mathbf{X}</span> is the
<span class="math inline">n \times p</span> design matrix (having <span class="math inline">p</span> quite large) with regression coefficients
<span class="math inline">\mathbf{\beta}</span>. When interest lies in
selecting the non-noise covariates and estimating the relevant effect,
one assumes the lasso penalized objective function (Tibshirani, 1996),
<span class="math display">\frac{1}{2}||\mathbf{y}-\mathbf{X}\mathbf{\beta}||_2^2+\lambda||\mathbf{\beta}||_1</span></p>
</div>
<div class="section level2">
<h2 id="the-r-functions">The R functions<a class="anchor" aria-label="anchor" href="#the-r-functions"></a>
</h2>
<p>The main function of the package are <em>islasso()</em> where the
user supplies the model formula as in the usual <em>lm</em> or
<em>glm</em> functions, i.e.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/islasso.html">islasso</a></span><span class="op">(</span><span class="va">formula</span>, family <span class="op">=</span> <span class="va">gaussian</span>, <span class="va">lambda</span>, alpha <span class="op">=</span> <span class="fl">1</span>, <span class="va">data</span>, <span class="va">weights</span>, <span class="va">subset</span>,</span>
<span>        <span class="va">offset</span>, <span class="va">unpenalized</span>, contrasts <span class="op">=</span> <span class="cn">NULL</span>, control <span class="op">=</span> <span class="fu"><a href="../reference/is.control.html">is.control</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>and <em>islasso.path</em> used to fit the regularization path via the
induced smoothed lasso framework, i.e.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/islasso.path.html">islasso.path</a></span><span class="op">(</span><span class="va">formula</span>, family <span class="op">=</span> <span class="va">gaussian</span>, lambda <span class="op">=</span> <span class="cn">NULL</span>, nlambda <span class="op">=</span> <span class="fl">100</span>, </span>
<span>             lambda.min.ratio <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">nobs</span> <span class="op">&lt;</span> <span class="va">nvars</span>, <span class="fl">1E-3</span>, <span class="fl">1E-05</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">1</span>, </span>
<span>             <span class="va">data</span>, <span class="va">weights</span>, <span class="va">subset</span>, <span class="va">offset</span>, <span class="va">unpenalized</span>, contrasts <span class="op">=</span> <span class="cn">NULL</span>, control <span class="op">=</span> <span class="fu"><a href="../reference/is.control.html">is.control</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><em>family</em> accepts specification of family and link function as
in Table 1, <em>lambda</em> is the tuning parameter, <em>alpha</em> is
elastic-net mixing parameter, <em>nlambda</em> is the number of lambda
values, <em>lambda.min.ratio</em> is the smallest value for lambda (as a
fraction of lambda.max), and <em>unpenalized</em> allows to indicate
covariates with unpenalized coefficients.</p>
<p><strong>Table 1. Families and link functions allowed in
islasso</strong></p>
<table class="table">
<thead><tr class="header">
<th align="left">family</th>
<th align="center">link</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">gaussian</td>
<td align="center">identity</td>
</tr>
<tr class="even">
<td align="left">binomial</td>
<td align="center">logit, probit</td>
</tr>
<tr class="odd">
<td align="left">poisson</td>
<td align="center">log</td>
</tr>
<tr class="even">
<td align="left">gamma</td>
<td align="center">identity, log, inverse</td>
</tr>
</tbody>
</table>
<p>The fitter functions are and which reads as</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/islasso.html">islasso.fit</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">lambda</span>, alpha <span class="op">=</span> <span class="fl">1</span>, intercept <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>            weights <span class="op">=</span> <span class="cn">NULL</span>, offset <span class="op">=</span> <span class="cn">NULL</span>, unpenalized <span class="op">=</span> <span class="cn">NULL</span>, control <span class="op">=</span> <span class="fu"><a href="../reference/is.control.html">is.control</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<p>and</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/islasso.path.html">islasso.path.fit</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">lambda</span>, <span class="va">nlambda</span>, <span class="va">lambda.min.ratio</span>, </span>
<span>                 alpha <span class="op">=</span> <span class="fl">1</span>, intercept <span class="op">=</span> <span class="cn">FALSE</span>, weights <span class="op">=</span> <span class="cn">NULL</span>, offset <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>                 unpenalized <span class="op">=</span> <span class="cn">NULL</span>, control <span class="op">=</span> <span class="fu"><a href="../reference/is.control.html">is.control</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<p>whose actually implements the estimating algorithm as described in
the paper. The <em>lambda</em> argument in <em>islasso.fit</em> and
<em>islasso</em> specifies the positive tuning parameter in the
penalized objective. Any non-negative value can be provided, but if
missing, it is computed via <span class="math inline">K</span>-fold
cross validation by the function <em>cv.glmnet()</em> from package
<strong>glmnet</strong>. The number of folds being used can be specified
via the argument <em>nfolds</em> of the auxiliary function
<em>is.control()</em>. The <em>lambda</em> argument in
<em>islasso.path.fit</em> and <em>islasso.path</em> specifies the
sequence of positive tuning parameters, user supplied or automatically
computed based on <em>nlambda</em> and <em>lambda.min.ratio</em>.</p>
</div>
<div class="section level2">
<h2 id="a-worked-example-the-diabetes-data-set">A worked example: the Diabetes data set<a class="anchor" aria-label="anchor" href="#a-worked-example-the-diabetes-data-set"></a>
</h2>
<p>We use the well-known <strong>diabetes</strong> dataset available in
the <strong>lars</strong> package. The data refer to <span class="math inline">n = 442</span> patients enrolled to investigate a
measure of disease progression one year after the baseline. There are
ten covariates, (age, sex, bmi (body mass index), map (average blood
pressure) and several blood serum measurements (tc, ldl, hdl, tch, ltg,
glu). The matrix <em>x2</em> in the dataframe also includes second-order
terms, namely first-order interactions between covariates, and quadratic
terms for the continuous variables.</p>
<p>To select the important terms in the regression equation we could
simply apply the lasso using the R package <strong>glmnet</strong></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gianluca-sottile.github.io/islasso/">islasso</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: glmnet</span></span>
<span><span class="co">#&gt; Loading required package: Matrix</span></span>
<span><span class="co">#&gt; Loaded glmnet 4.1-10</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co"><span style="color: #00BBBB;">#&gt; +----------------------------------------------+</span></span></span>
<span><span class="co"><span style="color: #00BBBB;">#&gt; |          Welcome to *islasso*                |</span></span></span>
<span><span class="co"><span style="color: #00BBBB;">#&gt; |  The Induced Smoothed Lasso for R            |</span></span></span>
<span><span class="co"><span style="color: #00BBBB;">#&gt; |  Hypothesis testing in high-dimensional data |</span></span></span>
<span><span class="co"><span style="color: #00BBBB;">#&gt; +----------------------------------------------+</span></span></span>
<span><span class="co"><span style="color: #00BBBB;">#&gt; </span></span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Prostate"</span>, package <span class="op">=</span> <span class="st">"islasso"</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="va">lpsa</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">Prostate</span><span class="op">)</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">Prostate</span><span class="op">$</span><span class="va">lpsa</span></span>
<span><span class="va">a1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://glmnet.stanford.edu/reference/cv.glmnet.html" class="external-link">cv.glmnet</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, family <span class="op">=</span> <span class="st">"gaussian"</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Prostate</span><span class="op">)</span></span>
<span><span class="va">a1</span><span class="op">$</span><span class="va">lambda.min</span> <span class="op">*</span> <span class="va">n</span></span>
<span><span class="co">#&gt; [1] 3.797398</span></span>
<span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/drop.html" class="external-link">drop</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">a1</span>, <span class="st">"lambda.min"</span>, exact <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">b</span><span class="op">[</span><span class="va">b</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 7</span></span></code></pre></div>
<p>Ten-fold cross validation “selects” <span class="math inline">\lambda=</span> 3.797. corresponding to 7 non null
coefficients</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">b</span><span class="op">[</span><span class="va">b</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "(Intercept)" "lcavol"      "lweight"     "age"         "lbph"       </span></span>
<span><span class="co">#&gt; [6] "svi"         "pgg45"</span></span></code></pre></div>
<p>The last three estimates are</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">b</span><span class="op">[</span><span class="va">b</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">]</span>, n <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;        lbph         svi       pgg45 </span></span>
<span><span class="co">#&gt; 0.069318034 0.592326060 0.002184294</span></span></code></pre></div>
<p>A reasonable question is if all the “selected” coefficients are
significant in the model. Unfortunately lasso regression does not return
standard errors due to nonsmoothness of objective, and some alternative
approaches have been proposed., including the (Lockhart et al., 2013).
Among the (few) strategies, including the ‘covariance test’, the
‘post-selection inference’ and the ‘(modified) residual bootstrap’, here
we illustrate the R package <strong>islasso</strong> implementing the
recent `quasi’ lasso approach based on the induced smoothing idea (Brown
and Wang, 2005) as discussed in Cilluffo et al. (2019)</p>
<p>While the optimal lambda could be selected (without supplying any
value to <em>lambda</em>), we use optimal value minimizing a specific
criterion chosen between AIC, BIC, AICc, BIC, GCV or GIC. From version
1.4.0 of the R package <strong>islasso</strong> optimal strategy is to
built the regularization path</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/islasso.path.html">islasso.path</a></span><span class="op">(</span><span class="va">lpsa</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">Prostate</span>, nlambda <span class="op">=</span> <span class="fl">50L</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">out</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; islasso.path(formula = lpsa ~ ., family = gaussian(), nlambda = 50L, </span></span>
<span><span class="co">#&gt;     data = Prostate)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;       lambda     df    phi deviance    logLik</span></span>
<span><span class="co">#&gt; 1     0.1333 8.9761 0.5018  44.1676 -100.4811</span></span>
<span><span class="co">#&gt; 2     0.1608 8.9710 0.5018  44.1696 -100.4833</span></span>
<span><span class="co">#&gt; 3     0.1941 8.9649 0.5018  44.1725 -100.4865</span></span>
<span><span class="co">#&gt; 4     0.2342 8.9573 0.5018  44.1767 -100.4912</span></span>
<span><span class="co">#&gt; 5     0.2825 8.9481 0.5018  44.1829 -100.4979</span></span>
<span><span class="co">#&gt; 6     0.3409 8.9368 0.5018  44.1918 -100.5077</span></span>
<span><span class="co">#&gt; 7     0.4113 8.9228 0.5019  44.2046 -100.5218</span></span>
<span><span class="co">#&gt; 8     0.4962 8.9056 0.5020  44.2232 -100.5421</span></span>
<span><span class="co">#&gt; 9     0.5987 8.8842 0.5022  44.2500 -100.5715</span></span>
<span><span class="co">#&gt; 10    0.7224 8.8576 0.5025  44.2885 -100.6137</span></span>
<span><span class="co">#&gt; 11    0.8716 8.8244 0.5029  44.3437 -100.6741</span></span>
<span><span class="co">#&gt; 12    1.0516 8.7826 0.5036  44.4225 -100.7602</span></span>
<span><span class="co">#&gt; 13    1.2688 8.7299 0.5045  44.5340 -100.8819</span></span>
<span><span class="co">#&gt; 14    1.5309 8.0067 0.5021  44.6791 -101.0396</span></span>
<span><span class="co">#&gt; 15    1.8471 7.9204 0.5038  44.8820 -101.2594</span></span>
<span><span class="co">#&gt; 16    2.2286 7.8248 0.5065  45.1655 -101.5647</span></span>
<span><span class="co">#&gt; 17    2.6889 7.7136 0.5102  45.5561 -101.9823</span></span>
<span><span class="co">#&gt; 18    3.2443 6.9726 0.5114  46.0426 -102.4975</span></span>
<span><span class="co">#&gt; 19    3.9145 6.7585 0.5158  46.5469 -103.0259</span></span>
<span><span class="co">#&gt; 20    4.7230 6.6541 0.5230  47.2510 -103.7541</span></span>
<span><span class="co">#&gt; 21    5.6985 6.5271 0.5330  48.2219 -104.7405</span></span>
<span><span class="co">#&gt; 22    6.8755 6.6267 0.5486  49.5782 -106.0858</span></span>
<span><span class="co">#&gt; 23    8.2956 6.1845 0.5656  51.3675 -107.8053</span></span>
<span><span class="co">#&gt; 24   10.0091 5.7038 0.5838  53.2999 -109.5964</span></span>
<span><span class="co">#&gt; 25   12.0764 5.2903 0.5997  54.9973 -111.1169</span></span>
<span><span class="co">#&gt; 26   14.5708 4.9208 0.6146  56.5942 -112.5050</span></span>
<span><span class="co">#&gt; 27   17.5803 4.6441 0.6288  58.0776 -113.7599</span></span>
<span><span class="co">#&gt; 28   21.2115 3.7489 0.6423  59.8984 -115.2571</span></span>
<span><span class="co">#&gt; 29   25.5927 3.4034 0.6649  62.2319 -117.1106</span></span>
<span><span class="co">#&gt; 30   30.8788 3.3301 0.6981  65.3864 -119.5088</span></span>
<span><span class="co">#&gt; 31   37.2567 3.2587 0.7418  69.5331 -122.4910</span></span>
<span><span class="co">#&gt; 32   44.9520 3.6938 0.8058  75.1879 -126.2831</span></span>
<span><span class="co">#&gt; 33   54.2367 3.5160 0.8870  82.9182 -131.0295</span></span>
<span><span class="co">#&gt; 34   65.4392 3.1442 0.9892  92.8465 -136.5145</span></span>
<span><span class="co">#&gt; 35   78.9555 2.6256 1.1001 103.8176 -141.9314</span></span>
<span><span class="co">#&gt; 36   95.2636 2.4779 1.1127 105.1725 -142.5603</span></span>
<span><span class="co">#&gt; 37  114.9401 2.3613 1.1124 105.2762 -142.6080</span></span>
<span><span class="co">#&gt; 38  138.6807 2.1349 1.1106 105.3552 -142.6444</span></span>
<span><span class="co">#&gt; 39  167.3248 2.0283 1.1105 105.4700 -142.6972</span></span>
<span><span class="co">#&gt; 40  201.8854 2.0023 1.1120 105.6370 -142.7740</span></span>
<span><span class="co">#&gt; 41  243.5843 1.9998 1.1145 105.8802 -142.8855</span></span>
<span><span class="co">#&gt; 42  293.8961 1.9993 1.1182 106.2340 -143.0473</span></span>
<span><span class="co">#&gt; 43  354.5996 1.9981 1.1236 106.7486 -143.2817</span></span>
<span><span class="co">#&gt; 44  427.8413 2.0038 1.1316 107.4951 -143.6196</span></span>
<span><span class="co">#&gt; 45  516.2109 1.9858 1.1427 108.5750 -144.1044</span></span>
<span><span class="co">#&gt; 46  622.8330 1.9603 1.1586 110.1161 -144.7880</span></span>
<span><span class="co">#&gt; 47  751.4777 1.9013 1.1806 112.2704 -145.7277</span></span>
<span><span class="co">#&gt; 48  906.6936 1.7895 1.2099 115.1909 -146.9732</span></span>
<span><span class="co">#&gt; 49 1093.9690 1.5932 1.2478 119.0497 -148.5713</span></span>
<span><span class="co">#&gt; 50 1319.9257 1.2931 1.2953 123.9704 -150.5356</span></span></code></pre></div>
<p>and then to choose the best tuning parameter through the one of the
criteria listed above using the function <em>GoF.islasso.path</em>,
e.g.,</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lmb.best</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GoF.islasso.path.html">GoF.islasso.path</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span></code></pre></div>
<p><img src="islasso-intro_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lmb.best</span><span class="op">$</span><span class="va">lambda.min</span></span>
<span><span class="co">#&gt;       AIC       BIC      AICc      eBIC       GCV       GIC </span></span>
<span><span class="co">#&gt;  1.530907  3.244343 25.592682  3.914454  3.244343  3.244343</span></span></code></pre></div>
<p>Using also the regularization path is very usefull to have more
insights about coefficients, standard errors and gradient profile</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out</span>, yvar <span class="op">=</span> <span class="st">"coefficients"</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out</span>, yvar <span class="op">=</span> <span class="st">"se"</span><span class="op">)</span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out</span>, yvar <span class="op">=</span> <span class="st">"gradient"</span><span class="op">)</span></span>
<span><span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, <span class="va">p3</span>, ncol <span class="op">=</span> <span class="fl">1L</span><span class="op">)</span></span></code></pre></div>
<p><img src="islasso-intro_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>Once selected the best lambda value minimizing for example the AIC
criterion, the last step of the strategy consists on fitting a new
islasso model.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lambda.bic</span> <span class="op">&lt;-</span> <span class="va">lmb.best</span><span class="op">$</span><span class="va">lambda.min</span><span class="op">[</span><span class="st">"AIC"</span><span class="op">]</span></span>
<span><span class="va">out2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/islasso.html">islasso</a></span><span class="op">(</span><span class="va">lpsa</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">Prostate</span>, lambda <span class="op">=</span> <span class="va">lambda.bic</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">out2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; islasso(formula = lpsa ~ ., family = gaussian(), lambda = lambda.bic, </span></span>
<span><span class="co">#&gt;     data = Prostate)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt; (Intercept)       lcavol      lweight          age         lbph          svi  </span></span>
<span><span class="co">#&gt;    1.074451     0.573820     0.389617    -0.016542     0.100958     0.572844  </span></span>
<span><span class="co">#&gt;         lcp      gleason        pgg45  </span></span>
<span><span class="co">#&gt;   -0.046512     0.000001     0.004925  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Degrees of Freedom: 96 Total (i.e. Null); 88.99 Residual</span></span>
<span><span class="co">#&gt; Null Deviance: 127.9 </span></span>
<span><span class="co">#&gt; Residual Deviance: 44.68 </span></span>
<span><span class="co">#&gt; AIC: 218.1 </span></span>
<span><span class="co">#&gt; Lambda: 1.531</span></span></code></pre></div>
<p>The <strong>summary</strong> method quickly returns the main output
of the fitted model, including point estimates, standard errors and
<span class="math inline">p</span>-values. Visualizing estimates for all
covariates could be somewhat inconvenient, especially when the number of
covariates is large, thus we decide to print estimates only if the
pvalue is less than a threshold value. We use <em>0.10</em></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">out2</span>, pval <span class="op">=</span> <span class="fl">0.10</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; islasso(formula = lpsa ~ ., family = gaussian(), lambda = lambda.bic, </span></span>
<span><span class="co">#&gt;     data = Prostate)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -1.65308 -0.37468 -0.01048  0.37197  1.64352 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;             Estimate Std. Error    Df z value Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt; (Intercept)  1.07445    0.83950 1.000   1.280   0.2006    </span></span>
<span><span class="co">#&gt; lcavol       0.57382    0.08430 1.000   6.807 9.96e-12 ***</span></span>
<span><span class="co">#&gt; lweight      0.38962    0.16573 0.987   2.351   0.0187 *  </span></span>
<span><span class="co">#&gt; lbph         0.10096    0.05725 0.985   1.763   0.0778 .  </span></span>
<span><span class="co">#&gt; svi          0.57284    0.23416 0.985   2.446   0.0144 *  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Dispersion parameter for gaussian family taken to be 0.502056)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Null deviance: 127.92  on 96.00  degrees of freedom</span></span>
<span><span class="co">#&gt; Residual deviance:  44.68  on 88.99  degrees of freedom</span></span>
<span><span class="co">#&gt; AIC: 218.09</span></span>
<span><span class="co">#&gt; Lambda: 1.5309</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Newton-Raphson iterations: 10</span></span></code></pre></div>
<p>In addition to the usual information printed by the summary method,
the output also includes the column <em>Df</em> representing the degrees
of freedom of each coefficient. Their sum is used to quantify the model
complexity</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">out2</span><span class="op">$</span><span class="va">internal</span><span class="op">$</span><span class="va">hi</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 8.006674</span></span></code></pre></div>
<p>and the corresponding residual degrees of freedom () as reported
above. The Wald test (column <em>z value</em>) and <span class="math inline">p</span>-values can be used to assess important or
significant covariates. Results suggest that variables bmi, map, hdl and
ltg to predict the measure of diabetes progression, while sex and two
interactions age:sex and bmi:map are borderline informative. Just to be
clear, another way to obtain a similar result without computing the
regularization path, is to use the function <em>aic.islasso</em> which
requires a preliminary islasso fit object and a specification of the
criterion to be used. Hence</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lambda.bic2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aic.islasso.html">aic.islasso</a></span><span class="op">(</span><span class="va">out2</span>, method <span class="op">=</span> <span class="st">"AIC"</span>, interval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">50</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Optimization through AIC</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; lambda =   19.1601 AIC =   237.91885 </span></span>
<span><span class="co">#&gt; lambda =   30.9399 AIC =   245.77014 </span></span>
<span><span class="co">#&gt; lambda =   11.8798 AIC =   232.62143 </span></span>
<span><span class="co">#&gt; lambda =    7.3803 AIC =   226.34327 </span></span>
<span><span class="co">#&gt; lambda =    4.5995 AIC =   220.59405 </span></span>
<span><span class="co">#&gt; lambda =    2.8808 AIC =   219.66168 </span></span>
<span><span class="co">#&gt; lambda =    2.9398 AIC =   219.75098 </span></span>
<span><span class="co">#&gt; lambda =    1.8186 AIC =   218.32970 </span></span>
<span><span class="co">#&gt; lambda =    1.1622 AIC =   219.15069 </span></span>
<span><span class="co">#&gt; lambda =    1.9195 AIC =   218.43005 </span></span>
<span><span class="co">#&gt; lambda =    1.7013 AIC =   218.22646 </span></span>
<span><span class="co">#&gt; lambda =    1.4954 AIC =   218.06882 </span></span>
<span><span class="co">#&gt; lambda =    1.3681 AIC =   217.98620 </span></span>
<span><span class="co">#&gt; lambda =    1.2894 AIC =   219.23594 </span></span>
<span><span class="co">#&gt; lambda =    1.4167 AIC =   218.01779 </span></span>
<span><span class="co">#&gt; lambda =    1.3381 AIC =   217.96882 </span></span>
<span><span class="co">#&gt; lambda =    1.3195 AIC =   219.25523 </span></span>
<span><span class="co">#&gt; lambda =    1.3495 AIC =   217.96997 </span></span>
<span><span class="co">#&gt; lambda =    1.3418 AIC =   217.97021 </span></span>
<span><span class="co">#&gt; lambda =    1.3310 AIC =   219.26258 </span></span>
<span><span class="co">#&gt; lambda =    1.3354 AIC =   219.26402 </span></span>
<span><span class="co">#&gt; lambda =    1.3395 AIC =   217.96808 </span></span>
<span><span class="co">#&gt; lambda =    1.3404 AIC =   217.96696 </span></span>
<span><span class="co">#&gt; lambda =    1.3410 AIC =   217.97116 </span></span>
<span><span class="co">#&gt; lambda =    1.3401 AIC =   217.96616 </span></span>
<span><span class="co">#&gt; lambda =    1.3400 AIC =   217.96475 </span></span>
<span><span class="co">#&gt; lambda =    1.3398 AIC =   217.96822 </span></span>
<span><span class="co">#&gt; lambda =    1.3399 AIC =   217.97010 </span></span>
<span><span class="co">#&gt; lambda =    1.3400 AIC =   217.96475</span></span>
<span><span class="va">out3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">out2</span>, lambda <span class="op">=</span> <span class="va">lambda.bic2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">out3</span>, pval <span class="op">=</span> <span class="fl">.10</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; islasso(formula = lpsa ~ ., family = gaussian(), lambda = lambda.bic2, </span></span>
<span><span class="co">#&gt;     data = Prostate)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -1.66294 -0.37527 -0.01031  0.38855  1.64233 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;             Estimate Std. Error    Df z value Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt; (Intercept)  1.05960    0.84619 1.000   1.252   0.2105    </span></span>
<span><span class="co">#&gt; lcavol       0.57584    0.08498 1.000   6.776 1.23e-11 ***</span></span>
<span><span class="co">#&gt; lweight      0.39689    0.16643 0.990   2.385   0.0171 *  </span></span>
<span><span class="co">#&gt; lbph         0.10178    0.05749 0.987   1.771   0.0766 .  </span></span>
<span><span class="co">#&gt; svi          0.59518    0.23648 0.989   2.517   0.0118 *  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Dispersion parameter for gaussian family taken to be 0.5011429)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Null deviance: 127.918  on 96.00  degrees of freedom</span></span>
<span><span class="co">#&gt; Residual deviance:  44.572  on 88.94  degrees of freedom</span></span>
<span><span class="co">#&gt; AIC: 217.96</span></span>
<span><span class="co">#&gt; Lambda: 1.34</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Newton-Raphson iterations: 10</span></span></code></pre></div>
<p>Comparisons between methods to select the tuning parameter and
further discussions are out of the scope of this short note. We conclude
this note by emphasizing that <strong>islasso</strong> also accepts the
so-called elastic-net penalty, such that <span class="math display">
\frac{1}{2}||\mathbf{y}- \mathbf{X\beta}||_2^{2}+\lambda \{ \alpha
||\mathbf{\beta} ||^{}_1 + \frac{1}{2}(1-\alpha) ||\mathbf{\beta}
||^{2}_2 \}
</span> where <span class="math inline">0\le \alpha\le 1</span> is the
mixing parameter to be specified in <em>islasso()</em> and
<em>islasso.path()</em> via the argument <em>alpha</em>, e.g.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># update the islasso path to fit an elastic-net model</span></span>
<span><span class="va">out4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">out</span>, alpha <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span></span>
<span><span class="va">out4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; islasso.path(formula = lpsa ~ ., family = gaussian(), nlambda = 50L, </span></span>
<span><span class="co">#&gt;     alpha = 0.5, data = Prostate)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;       lambda     df    phi deviance    logLik</span></span>
<span><span class="co">#&gt; 1     0.2666 8.9540 0.5017  44.1702 -100.4840</span></span>
<span><span class="co">#&gt; 2     0.3217 8.9445 0.5017  44.1733 -100.4874</span></span>
<span><span class="co">#&gt; 3     0.3881 8.9328 0.5016  44.1779 -100.4925</span></span>
<span><span class="co">#&gt; 4     0.4683 8.9188 0.5016  44.1845 -100.4997</span></span>
<span><span class="co">#&gt; 5     0.5650 8.9017 0.5016  44.1941 -100.5102</span></span>
<span><span class="co">#&gt; 6     0.6817 8.8810 0.5017  44.2078 -100.5253</span></span>
<span><span class="co">#&gt; 7     0.8226 8.8558 0.5018  44.2275 -100.5469</span></span>
<span><span class="co">#&gt; 8     0.9925 8.8251 0.5019  44.2557 -100.5778</span></span>
<span><span class="co">#&gt; 9     1.1974 8.7878 0.5022  44.2959 -100.6218</span></span>
<span><span class="co">#&gt; 10    1.4448 8.7423 0.5025  44.3529 -100.6841</span></span>
<span><span class="co">#&gt; 11    1.7432 8.6868 0.5031  44.4332 -100.7720</span></span>
<span><span class="co">#&gt; 12    2.1032 8.6191 0.5040  44.5458 -100.8947</span></span>
<span><span class="co">#&gt; 13    2.5377 8.5365 0.5053  44.7017 -101.0641</span></span>
<span><span class="co">#&gt; 14    3.0618 7.8238 0.5036  44.9049 -101.2841</span></span>
<span><span class="co">#&gt; 15    3.6942 7.7078 0.5060  45.1809 -101.5813</span></span>
<span><span class="co">#&gt; 16    4.4573 7.5819 0.5094  45.5527 -101.9787</span></span>
<span><span class="co">#&gt; 17    5.3779 6.8248 0.5098  45.9746 -102.4259</span></span>
<span><span class="co">#&gt; 18    6.4887 6.6362 0.5138  46.4262 -102.8999</span></span>
<span><span class="co">#&gt; 19    7.8289 6.6102 0.5205  47.0458 -103.5429</span></span>
<span><span class="co">#&gt; 20    9.4459 6.8886 0.5319  47.9332 -104.4493</span></span>
<span><span class="co">#&gt; 21   11.3970 6.6206 0.5438  49.1459 -105.6610</span></span>
<span><span class="co">#&gt; 22   13.7510 6.3072 0.5588  50.6764 -107.1484</span></span>
<span><span class="co">#&gt; 23   16.5912 5.9402 0.5774  52.5775 -108.9345</span></span>
<span><span class="co">#&gt; 24   20.0181 5.5303 0.5989  54.7831 -110.9276</span></span>
<span><span class="co">#&gt; 25   24.1528 5.1570 0.6207  57.0024 -112.8535</span></span>
<span><span class="co">#&gt; 26   29.1415 4.8164 0.6435  59.3193 -114.7859</span></span>
<span><span class="co">#&gt; 27   35.1606 3.8405 0.6614  61.6176 -116.6295</span></span>
<span><span class="co">#&gt; 28   42.4230 3.5911 0.6886  64.3186 -118.7102</span></span>
<span><span class="co">#&gt; 29   51.1854 3.4481 0.7246  67.7886 -121.2586</span></span>
<span><span class="co">#&gt; 30   61.7576 3.6817 0.7731  72.1477 -124.2812</span></span>
<span><span class="co">#&gt; 31   74.5135 3.4501 0.8260  77.2703 -127.6081</span></span>
<span><span class="co">#&gt; 32   89.9040 3.3208 0.8884  83.2288 -131.2108</span></span>
<span><span class="co">#&gt; 33  108.4735 3.1424 0.9596  90.0654 -135.0396</span></span>
<span><span class="co">#&gt; 34  130.8784 2.8654 1.0348  97.4128 -138.8430</span></span>
<span><span class="co">#&gt; 35  157.9111 2.5229 1.1029 104.2028 -142.1110</span></span>
<span><span class="co">#&gt; 36  190.5272 2.3829 1.1127 105.2810 -142.6102</span></span>
<span><span class="co">#&gt; 37  229.8802 2.2673 1.1132 105.4538 -142.6898</span></span>
<span><span class="co">#&gt; 38  277.3614 2.0977 1.1128 105.6061 -142.7598</span></span>
<span><span class="co">#&gt; 39  334.6497 1.9705 1.1136 105.8208 -142.8583</span></span>
<span><span class="co">#&gt; 40  403.7708 1.9332 1.1163 106.1233 -142.9967</span></span>
<span><span class="co">#&gt; 41  487.1687 1.9177 1.1206 106.5466 -143.1898</span></span>
<span><span class="co">#&gt; 42  587.7922 1.9018 1.1266 107.1346 -143.4567</span></span>
<span><span class="co">#&gt; 43  709.1992 1.8830 1.1349 107.9438 -143.8217</span></span>
<span><span class="co">#&gt; 44  855.6826 1.8684 1.1462 109.0445 -144.3137</span></span>
<span><span class="co">#&gt; 45 1032.4218 1.8282 1.1613 110.5205 -144.9658</span></span>
<span><span class="co">#&gt; 46 1245.6661 1.7808 1.1810 112.4538 -145.8069</span></span>
<span><span class="co">#&gt; 47 1502.9554 1.7051 1.2058 114.9033 -146.8519</span></span>
<span><span class="co">#&gt; 48 1813.3873 1.5916 1.2355 117.8800 -148.0924</span></span>
<span><span class="co">#&gt; 49 2187.9381 1.4229 1.2698 121.3653 -149.5056</span></span>
<span><span class="co">#&gt; 50 2639.8515 1.1963 1.3073 125.2452 -151.0318</span></span>
<span></span>
<span><span class="co"># some diagnostic plot</span></span>
<span><span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out4</span>, yvar <span class="op">=</span> <span class="st">"coefficients"</span><span class="op">)</span></span>
<span><span class="va">p5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out4</span>, yvar <span class="op">=</span> <span class="st">"se"</span><span class="op">)</span></span>
<span><span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">p4</span>, <span class="va">p5</span>, ncol <span class="op">=</span> <span class="fl">1L</span><span class="op">)</span></span></code></pre></div>
<p><img src="islasso-intro_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># select the best tuning parameter</span></span>
<span><span class="va">lmb.best2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GoF.islasso.path.html">GoF.islasso.path</a></span><span class="op">(</span><span class="va">out4</span><span class="op">)</span></span></code></pre></div>
<p><img src="islasso-intro_files/figure-html/unnamed-chunk-12-2.png" width="700"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lmb.best2</span><span class="op">$</span><span class="va">lambda.min</span></span>
<span><span class="co">#&gt;       AIC       BIC      AICc      eBIC       GCV       GIC </span></span>
<span><span class="co">#&gt;  3.061814  5.377894 42.422996  6.488685  5.377894  5.377894</span></span>
<span></span>
<span><span class="co"># fit a new islasso model with elastic-net penalty</span></span>
<span><span class="va">lambda.bic3</span> <span class="op">&lt;-</span> <span class="va">lmb.best2</span><span class="op">$</span><span class="va">lambda.min</span><span class="op">[</span><span class="st">"AIC"</span><span class="op">]</span></span>
<span><span class="va">out5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">out2</span>, alpha <span class="op">=</span> <span class="fl">.5</span>, lambda <span class="op">=</span> <span class="va">lambda.bic3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">out5</span>, pval <span class="op">=</span> <span class="fl">.10</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; islasso(formula = lpsa ~ ., family = gaussian(), lambda = lambda.bic3, </span></span>
<span><span class="co">#&gt;     alpha = 0.5, data = Prostate)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -1.63555 -0.36932  0.00011  0.39077  1.63160 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;             Estimate Std. Error    Df z value Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt; (Intercept)  1.09123    0.82617 1.000   1.321   0.1866    </span></span>
<span><span class="co">#&gt; lcavol       0.56168    0.08145 0.975   6.896 5.35e-12 ***</span></span>
<span><span class="co">#&gt; lweight      0.38098    0.15899 0.948   2.396   0.0166 *  </span></span>
<span><span class="co">#&gt; lbph         0.09957    0.05610 0.971   1.775   0.0759 .  </span></span>
<span><span class="co">#&gt; svi          0.53984    0.21749 0.920   2.482   0.0131 *  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Dispersion parameter for gaussian family taken to be 0.503556)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Null deviance: 127.918  on 96.00  degrees of freedom</span></span>
<span><span class="co">#&gt; Residual deviance:  44.905  on 89.18  degrees of freedom</span></span>
<span><span class="co">#&gt; AIC: 218.22</span></span>
<span><span class="co">#&gt; Lambda: 3.0618</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Newton-Raphson iterations: 10</span></span>
<span></span>
<span><span class="co"># or select the best tuning parameter using AIC with an islasso object</span></span>
<span><span class="va">lambda.bic4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aic.islasso.html">aic.islasso</a></span><span class="op">(</span><span class="va">out5</span>, method <span class="op">=</span> <span class="st">"AIC"</span>, interval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Optimization through AIC</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; lambda =   38.2584 AIC =   242.28062 </span></span>
<span><span class="co">#&gt; lambda =   61.8416 AIC =   255.97650 </span></span>
<span><span class="co">#&gt; lambda =   23.6832 AIC =   235.66356 </span></span>
<span><span class="co">#&gt; lambda =   14.6752 AIC =   227.83485 </span></span>
<span><span class="co">#&gt; lambda =    9.1080 AIC =   222.34228 </span></span>
<span><span class="co">#&gt; lambda =    5.6672 AIC =   218.58817 </span></span>
<span><span class="co">#&gt; lambda =    3.5407 AIC =   218.48045 </span></span>
<span><span class="co">#&gt; lambda =    4.4685 AIC =   219.13421 </span></span>
<span><span class="co">#&gt; lambda =    2.2265 AIC =   219.07120 </span></span>
<span><span class="co">#&gt; lambda =    4.4297 AIC =   219.09585 </span></span>
<span><span class="co">#&gt; lambda =    3.0387 AIC =   218.20451 </span></span>
<span><span class="co">#&gt; lambda =    2.7285 AIC =   218.05736 </span></span>
<span><span class="co">#&gt; lambda =    2.5367 AIC =   219.19927 </span></span>
<span><span class="co">#&gt; lambda =    2.8470 AIC =   218.11420 </span></span>
<span><span class="co">#&gt; lambda =    2.6553 AIC =   219.24969 </span></span>
<span><span class="co">#&gt; lambda =    2.7738 AIC =   218.09241 </span></span>
<span><span class="co">#&gt; lambda =    2.7005 AIC =   218.04309 </span></span>
<span><span class="co">#&gt; lambda =    2.6832 AIC =   219.26164 </span></span>
<span><span class="co">#&gt; lambda =    2.7112 AIC =   218.04643 </span></span>
<span><span class="co">#&gt; lambda =    2.6922 AIC =   219.25501 </span></span>
<span><span class="co">#&gt; lambda =    2.7046 AIC =   218.04976 </span></span>
<span><span class="co">#&gt; lambda =    2.6973 AIC =   218.04238 </span></span>
<span><span class="co">#&gt; lambda =    2.6954 AIC =   218.04531 </span></span>
<span><span class="co">#&gt; lambda =    2.6986 AIC =   218.04668 </span></span>
<span><span class="co">#&gt; lambda =    2.6966 AIC =   218.04283 </span></span>
<span><span class="co">#&gt; lambda =    2.6978 AIC =   218.04661 </span></span>
<span><span class="co">#&gt; lambda =    2.6971 AIC =   218.04656 </span></span>
<span><span class="co">#&gt; lambda =    2.6975 AIC =   218.04465 </span></span>
<span><span class="co">#&gt; lambda =    2.6972 AIC =   218.04045 </span></span>
<span><span class="co">#&gt; lambda =    2.6972 AIC =   218.04733 </span></span>
<span><span class="co">#&gt; lambda =    2.6973 AIC =   218.04122 </span></span>
<span><span class="co">#&gt; lambda =    2.6972 AIC =   218.04045</span></span>
<span><span class="va">out6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">out5</span>, lambda <span class="op">=</span> <span class="va">lambda.bic4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">out6</span>, pval <span class="op">=</span> <span class="fl">.10</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; islasso(formula = lpsa ~ ., family = gaussian(), lambda = lambda.bic4, </span></span>
<span><span class="co">#&gt;     alpha = 0.5, data = Prostate)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -1.64659 -0.37033 -0.00621  0.36601  1.63182 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;             Estimate Std. Error    Df z value Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt; (Intercept)  1.07554    0.83321 1.000   1.291   0.1968    </span></span>
<span><span class="co">#&gt; lcavol       0.56489    0.08237 0.977   6.858 6.99e-12 ***</span></span>
<span><span class="co">#&gt; lweight      0.38879    0.16028 0.954   2.426   0.0153 *  </span></span>
<span><span class="co">#&gt; lbph         0.10048    0.05643 0.974   1.781   0.0750 .  </span></span>
<span><span class="co">#&gt; svi          0.56322    0.22116 0.930   2.547   0.0109 *  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Dispersion parameter for gaussian family taken to be 0.5023252)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Null deviance: 127.918  on 96.00  degrees of freedom</span></span>
<span><span class="co">#&gt; Residual deviance:  44.762  on 89.11  degrees of freedom</span></span>
<span><span class="co">#&gt; AIC: 218.04</span></span>
<span><span class="co">#&gt; Lambda: 2.6972</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Newton-Raphson iterations: 10</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li>Tibshirani R. <em>Regression shrinkage and selection via the
lasso</em>. J R Stat Soc: Series B 1996; 58: 267–288</li>
<li>Cilluffo, G, Sottile, G, La Grutta, S and Muggeo, VMR (2019) <em>The
Induced Smoothed lasso: A practical framework for hypothesis testing in
high dimensional regression</em>. Statistical Methods in Medical
Research, online doi: 10.1177/0962280219842890.</li>
<li>Brown B and Wang Y. <em>Standard errors and covariance matrices for
smoothed rank estimators</em>. Biometrika 2005; 92: 149–158.</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gianluca Sottile, Giovanna Cilluffo, Vito MR Muggeo.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
